name: JFrog Docker Scan Workflow

on:
  push:
    branches:
      - main

jobs:
  jfrog-docker-scan:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2
      
    - name: Setup JFrog CLI
      uses: jfrog/setup-jfrog-cli@v1
      with:
        version: '2.77.0'

    

    - name: Configure JFrog CLI
      run: |
        jfrog config add my-artifactory --url "https://hts2.jfrog.io/" --user "sss" --password "Test@123" --interactive=false

    - name: Pull Docker image
      run: |
        docker pull nginx:latest
        docker tag nginx:latest hts2-sss-docker-local.jfrog.io/nginx:latest
        jfrog rt dp hts2-sss-docker-local.jfrog.io/nginx:latest sss-docker-local --build-name=check --build-number=2
        jfrog rt build-publish check 2
        jfrog bs check 2

    # - name: Perform JFrog Docker scan
    #   run: |
    #     jfrog docker scan nginx:latest \
    #     --watches "failbuild" \
    #     --fail=false
          
